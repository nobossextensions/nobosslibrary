var nobossmodal={loadedJsAndCss:[],CONSTRUCTOR:function(){jconfirm.defaults={draggable:!1,useBootstrap:!0,animateFromElement:!1,columnClass:"modal-confirm-responsive"},nobossmodal.infos=Joomla.getOptions("nobossmodal"),jQuery("#module-form, #form-group").off("focusout change"),jQuery("body").on("click","[data-id=noboss-modal]",nobossmodal.loadModal),jQuery("#module-form, #form-group").on("submit",nobossmodal.interceptFormSubmit),jQuery("body").on("click","[data-id=modal] [data-id=button-confirm]",nobossmodal.confirmModal),jQuery("body").on("click","[data-id=modal] [data-id=button-cancel]",nobossmodal.cancelModal),jQuery("body").on("click","[data-id=modal] [data-id=button-reset]",nobossmodal.resetModal),jQuery("body").on("click","[data-id=modal] [data-id=modal-nav-tabs] [data-id=modal-tab]",nobossmodal.tabNavigation)},interceptFormSubmit:function(a){},loadModal:function(a){a.preventDefault();var e=jQuery(this);if(jQuery(e).attr("disabled"))return!1;var o=jQuery(e).siblings("[data-id=modal]");if(0===o.length){nobossmodal.addLoader(jQuery(e));var n=jQuery(e).siblings("[data-id=noboss-modal-input-hidden]").val(),t=jQuery(e).siblings("[data-id=noboss-modal-input-hidden]").data("modal-name"),s=jQuery(e).siblings("[data-id=noboss-modal-input-hidden]").data("formsource");nobossmodal.ajaxAndInsertModal(e,n,t,s).done(function(a){nobossmodal.openModal(jQuery(e).siblings("[data-id=modal]"))})}else nobossmodal.openModal(o)},addLoader:function(a){nobossmodal.disableButtons(!0);var e=jQuery('<div class="loader loader--side"></div>');jQuery(a).after(e)},removeLoader:function(){jQuery(".controls").children(".loader.loader--side").remove(),nobossmodal.disableButtons(!1)},disableButtons:function(a){jQuery("[data-id=noboss-modal]:visible").attr("disabled",a)},ajaxAndInsertModal:function(o,a,e,n){return jQuery.ajax({url:"../administrator/index.php?option=com_nobossajax&library=noboss.forms.fields.nobossmodal.nobossmodal&method=loadModal&format=raw",data:{data:a,modalName:e,xmlPath:n},type:"POST"}).done(function(a){nobossmodal.removeLoader();var e=jQuery(a).insertAfter(o);nobossmodal.verifyAndLoadJsCss(e)}).fail(function(){jQuery.alert({title:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONNECTION_ERROR_TITLE,content:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONNECTION_ERROR_CONTENT,buttons:{ok:function(){nobossmodal.removeLoader()}}})})},verifyAndLoadJsCss:function(e){var o,n=nobossmodal.loadedJsAndCss.map(function(a){if(-1===a.indexOf("html5fallback")&&"js"===a.slice(-2)&&0===jQuery("script[src*='"+a.slice(-30)+"']").length||"css"===a.slice(-3)&&0===jQuery("link[href*='"+a.slice(-30)+"']").length)return a});0<n.join("|").indexOf("minicolors.min.js")&&(o=e.find(".minicolors")).removeClass("minicolors");var a=n.map(function(a){if(a){if("js"===a.slice(-2)&&0===jQuery("script[src*='"+a.slice(-30)+"']").length)return jQuery("head").append('<script type="text/javascript" src="'+a+'"><\/script>');if("css"===a.slice(-3)&&0===jQuery("link[href*='"+a.slice(-30)+"']").length)return jQuery("head").append('<link rel="stylesheet" href="'+a+'"/>')}});n=n.join("|"),jQuery.when.apply(null,a).done(function(){if(jQuery(e).find("form select").chosen(),jQuery(e).find("form select[multiple=multiple]").chosen().change(function(){jQuery(this).chosen("destroy"),jQuery(this).chosen("liszt:updated")}),o&&o.addClass("minicolors"),nobossmodal.infos.higherJVersion&&e.find(".minicolors").each(function(){jQuery(this).minicolors({control:jQuery(this).attr("data-control")||"hue",format:"color"===jQuery(this).attr("data-validate")?"hex":("rgba"===jQuery(this).attr("data-format")?"rgb":jQuery(this).attr("data-format"))||"hex",keywords:jQuery(this).attr("data-keywords")||"",opacity:"rgba"===jQuery(this).attr("data-format"),position:jQuery(this).attr("data-position")||"default",theme:"bootstrap"})}),0<n.indexOf("calendar")){var a=document.createEvent("Event");a.initEvent("DOMContentLoaded",!0,!0),window.document.dispatchEvent(a)}nobossmodal.fixScripts(e)})},fixScripts:function(a){a.find('a[onclick*="jInsertFieldValue"]').each(function(){var a=jQuery(this),e=a.siblings('input[type="text"]').attr("id"),o=a.prev(),n=o.attr("href");a.attr("onclick","jInsertFieldValue('', '"+e+"');return false;"),o.attr("href",n.replace(/&fieldid=(.+)&/,"&fieldid="+e+"&"))}),jQuery.fn.fieldMedia&&a.find(".field-media-wrapper").fieldMedia(),jQuery.fn.popover&&a.find(".hasPopover").popover({trigger:"hover focus"}),jQuery.fn.fieldUser&&a.find(".field-user-wrapper").fieldUser(),window.Calendar&&(elements=a.find(".field-calendar"),elements.each(function(){JoomlaCalendar.init(this)})),nobossmodal.activateYesno(a),a.find(".fieldset").each(function(){jQuery(document).trigger("subform-row-add",this),jQuery(document).trigger("new-container-add",this),nobossmodal.infos.lowerJVersion&&jQuery(this).find(".minicolors").each(function(){var a=jQuery(this).val().replace("#","");jQuery(this).minicolors({control:jQuery(this).attr("data-control")||"hue",format:"color"===jQuery(this).attr("data-validate")?"hex":("rgba"===jQuery(this).attr("data-format")?"rgb":jQuery(this).attr("data-format"))||"hex",keywords:jQuery(this).attr("data-keywords")||"",opacity:"rgba"===jQuery(this).attr("data-format"),position:jQuery(this).attr("data-position")||"default",theme:"bootstrap"}),jQuery(this).minicolors("value",a)})})},openModal:function(l){l.find("[name=nb-modal-form]").find("[data-tab-id]").each(function(){var e=jQuery(this).closest(".nb-modal-content").find("[data-id=modal-nav-tabs]").find("[href=#"+jQuery(this).data("tab-id")+"]");if(jQuery(this).data("nbshowon")){var a=jQuery(this).data("nbshowon").split(";"),o=a[a.length-1].split(":"),n=o[o.length-1].split(","),t=!0;if("!"===o[0].slice(-1)&&(o[0]=o[0].slice(0,-1),t=!1),"outside"==a[0])nameContext=jQuery(this).closest(".control-group").closest(".controls").children("input[type=hidden][name^=jform]").attr("name"),fieldName=nameContext.replace(/\[[^\[\]]+\](?=[^\[\]]*$)/,"["+o[0]+"]");else{if("inner"==a[0]){modalRawName=l.data("modal-name"),fieldName=modalRawName+"\\["+o[0]+"\\]";var s=jQuery("[name="+fieldName+"]");if(!s.data("has-nbshowon-event-"+jQuery(this).data("tab-id"))){jQuery(s).on("change",function(a){nobossmodal.validateAndChangeTab(t,jQuery(this).val(),n,e)});var i=s.val();"radio"==s.attr("type")&&(i=s.filter(":checked").val()),nobossmodal.validateAndChangeTab(t,i,n,e),s.each(function(){s.data("has-nbshowon-event-"+jQuery(this).data("tab-id"),!0)})}return!0}modalRawName=l.data("modal-name"),fieldName=l.siblings("[type=hidden]").attr("name").replace(modalRawName,o[0])}var d=fieldName.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),r=jQuery("[name='"+d+"']").val();"radio"==jQuery("[name='"+d+"']").attr("type")&&(r=jQuery("[name='"+d+"']:checked").val()),nobossmodal.validateAndChangeTab(t,r,n,e),jQuery(this).closest(".nb-modal-content").find("[data-id=modal-nav-tabs]").find("li a").each(function(){if("none"!==jQuery(this).css("display"))return jQuery(this).trigger("click"),!1})}}),nobossmodal.toogleBodyBackgroundFade(!0),l.removeClass("hidden")},validateAndChangeTab:function(a,e,o,n){a&&-1<jQuery.inArray(e,o)||!a&&-1==jQuery.inArray(e,o)?n.show():n.hide()},tabNavigation:function(a){a.preventDefault();var e=jQuery(this).closest('[data-id="modal"]'),o=jQuery(this).attr("href").replace("#","");jQuery(this).siblings("[data-id=modal-tab]").removeClass("active"),e.find("[data-id=nb-modal-form] [data-tab-id]").removeClass("active"),e.find("[data-id=nb-modal-form]").find("[data-tab-id="+o+"]").addClass("active")},activateYesno:function(a){a.find(".radio.btn-group label").addClass("btn"),a.find("fieldset.btn-group").each(function(){jQuery(this).prop("disabled")&&(jQuery(this).css("pointer-events","none").off("click"),jQuery(this).find(".btn").addClass("disabled"))}),a.find(".btn-group label:not(.active)").click(function(){var a=jQuery(this),e=jQuery("#"+a.attr("for"));e.prop("checked")||(a.closest(".btn-group").find("label").removeClass("active btn-success btn-danger btn-primary"),""===e.val()?a.addClass("active btn-primary"):"0"===e.val()?a.addClass("active btn-danger"):a.addClass("active btn-success"),e.prop("checked",!0),e.trigger("change"))}),a.find('.btn-group input[checked="checked"]').each(function(){var a=jQuery(this);""===a.val()?a.parent().find('label[for="'+a.attr("id")+'"]').addClass("active btn-primary"):"0"===a.val()?a.parent().find('label[for="'+a.attr("id")+'"]').addClass("active btn-danger"):a.parent().find('label[for="'+a.attr("id")+'"]').addClass("active btn-success")})},confirmModal:function(a){a.preventDefault();var e=jQuery(this).closest('[data-id="modal"]'),o=nobossmodal.generateJsonValue(e);jQuery(e).siblings('[data-id="noboss-modal-input-hidden"]').val(o),jQuery(e).addClass("hidden"),nobossmodal.toogleBodyBackgroundFade(!1)},cancelModal:function(a){a.preventDefault();var e=jQuery(this).closest('[data-id="modal"]');nobossmodal.generateJsonValue(e)!==jQuery(e).siblings("[data-id=noboss-modal-input-hidden]").val()?jQuery.confirm({title:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CANCEL_LABEL,content:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CANCEL_DESC,type:"blue",closeIcon:"cancel",escapeKey:"cancel",buttons:{cancel:{keys:["esc"],text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CANCEL_BUTTON},confirm:{text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CONFIRM_BUTTON,btnClass:"btn-blue",keys:["enter"],action:function(){jQuery(e).siblings("script").remove(),jQuery(e).remove(),nobossmodal.toogleBodyBackgroundFade(!1)}}}}):(jQuery(e).siblings("script").remove(),jQuery(e).remove(),nobossmodal.toogleBodyBackgroundFade(!1))},resetModal:function(a){a.preventDefault();var n=jQuery(this).closest('[data-id="modal"]');jQuery.confirm({title:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_RESET_LABEL,content:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_RESET_DESC,type:"blue",closeIcon:"cancel",escapeKey:"cancel",buttons:{cancel:{keys:["esc"],text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CANCEL_BUTTON},confirm:{text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CONFIRM_BUTTON,btnClass:"btn-blue",keys:["enter"],action:function(){var o=jQuery(n).siblings("[data-id=noboss-modal-input-hidden]").val();jQuery(n).siblings("[data-id=noboss-modal-input-hidden]").val(""),jQuery(n).siblings("script").remove();var a=jQuery(n).siblings("[data-id=noboss-modal-input-hidden]").data("modal-name"),e=jQuery(n).siblings("[data-id=noboss-modal-input-hidden]").data("formsource");jQuery(n).find(".nb-modal-content").append('<div class="loader-fade"></div>'),jQuery(n).find(".nb-modal-content").append('<div class="loader loader--fullpage"></div>'),nobossmodal.ajaxAndInsertModal(jQuery(n),"",a,e).done(function(a){var e=jQuery(n).siblings('[data-id="modal"]');jQuery(e).siblings("[data-id=noboss-modal-input-hidden]").val(o),setTimeout(function(){jQuery(n).remove(),nobossmodal.openModal(e)},500)})}}}})},generateJsonValue:function(a){var e=jQuery(a).find("form"),i=a.data("modal-name"),o=e.serializeArray(),d={};return jQuery(o).each(function(a,e){var o=new RegExp(i+"\\[(.*?)\\]");if(e.name=e.name.split(o).join(""),/.*\[.*\].*/.test(e.name)){var n=e.name.split("[")[0],t=e.name.split(/\[(.*?)\]/)[1];if(void 0===d[n]&&(d[n]=t?{}:[]),t)if(void 0!==d[n][t])if(Array.isArray(d[n][t]))d[n][t].push(e.value);else{var s=d[n][t];d[n][t]=[],d[n][t].push(s),d[n][t].push(e.value)}else d[n][t]=e.value;else d[n].push(e.value)}else d[e.name]=e.value}),JSON.stringify(d)},toogleBodyBackgroundFade:function(a){a?jQuery("body").addClass("modal--is-open"):(jQuery("body").removeClass("modal--is-open"),jQuery(document).trigger("modalClosed"))}};jQuery(document).ready(function(e){$=e;var a=["../libraries/noboss/assets/plugins/js/min/jquery-confirm.min.js","../libraries/noboss/assets/plugins/stylesheets/css/jquery-confirm.min.css"].map(function(a){return"js"===a.slice(-2)&&0===e("script[src*='"+a.slice(-30)+"']").length?e("head").append('<script type="text/javascript" src="'+a+'"><\/script>'):"css"===a.slice(-3)&&0===e("link[href*='"+a.slice(-30)+"']").length?e("head").append('<link rel="stylesheet" href="'+a+'"/>'):void 0});e.when.apply(null,a).done(function(){nobossmodal.CONSTRUCTOR()})});