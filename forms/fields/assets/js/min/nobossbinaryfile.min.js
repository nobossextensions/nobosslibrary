jQuery(document).ready(function(e){binaryFile.CONSTRUCTOR()});var binaryFile={CONSTRUCTOR:function(){var e=jQuery(".file-upload-context");e.on("change",'input[data-id="upload-binary"]',function(e){binaryFile.alterFile(jQuery(this))}),e.on("focusout",'[data-id="seeFile"]',function(e){jQuery(this).closest(".file-upload-context").find(".tooltip-image").addClass("hidden")}),e.on("click","[data-id='deleteFile']",function(e){e.preventDefault();var i=jQuery(this).closest(".file-upload-context");i.find("[data-id='upload-binary-img']").val(""),i.find("[data-id='upload-binary-img']").addClass("hidden"),i.find("[data-id='upload-binary']").val(""),i.find("[data-id='upload-binary-hidden']").val(""),i.find("[data-id='file-options']").addClass("hidden")}),jQuery(".file-upload-context").on("click","a[data-id=seeFile]",binaryFile.imgBtnActivate),jQuery.event.trigger({type:"binnaryFileRequisitionEnds"})},alterFile:function(t){if(""!==t.val()){var d=t.attr("name"),r=t.closest(".file-upload-context");r.siblings("div[data-field='error_"+d+"']").remove(),t.attr("disabled",!0);var l=r.find("[data-id='file-options']");l.addClass("hidden");var e=jQuery("[data-id='upload-binary']"),i=t[0].files[0],a=new FormData;a.append("formFile",i),a.append("dataParamsField",e.attr("data-params-field"));var n=t.attr("data-url"),o=r.find("[data-id='upload-binary-img']");o.addClass("hidden"),jQuery.ajax({url:baseNameUrl+n,data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e){if(e=jQuery.parseJSON(e),r.trigger("binnaryFileRequisitionEnds"),e.hasOwnProperty("error"))0===jQuery("div[data-field='error_"+d+"']").length&&jQuery("<div data-field='error_"+d+"' class='alert alert-danger'>"+e.error+"</div>").insertAfter(r);else{var i=t.siblings("input[data-id=upload-binary-hidden]");binaryFile.verifyType(e.mimeTypeFile,"image")?(o.attr("src",e.imageSrcDisplay),o.removeClass("hidden")):o.addClass("hidden");var a={stringFile:e.stringFile,mimeTypeFile:e.mimeTypeFile},n=JSON.stringify(a);i.val(n),i.attr("mime",e.mimeTypeFile),l.removeClass("hidden")}t.removeAttr("disabled",!0)}})}},verifyType:function(e,i){return-1!=e.search(i)},imgBtnDesactivate:function(e){e.stopPropagation(),binaryFile.nowThis.siblings(".tooltip-image").addClass("hidden"),binaryFile.nowThis={},jQuery("html").off("click","body",binaryFile.imgBtnDesactivate)},imgBtnActivate:function(e){e.preventDefault(),e.stopPropagation();var i=jQuery(this),a=i.closest(".file-upload-context"),n=a.find(".tooltip-image");console.log(n);var t=a.find("input[data-id=upload-binary-hidden]").val(),d=jQuery.parseJSON(t),r=d.stringFile,l=d.mimeTypeFile;binaryFile.verifyType(l,"image")?n.hasClass("hidden")?n.removeClass("hidden"):n.addClass("hidden"):binaryFile.displayFile(l,r),jQuery("html").off("click","body",binaryFile.imgBtnDesactivate),jQuery("html").on("click","body",binaryFile.imgBtnDesactivate),binaryFile.nowThis=i},displayFile:function(e,i){if(binaryFile.detectIE()){var a=baseNameUrl+"index.php?option=com_nobossajax&library=noboss.file.binaryfromfile&method=viewFile",n=jQuery("[data-id='upload-binary-hidden']").clone();n.attr("name","fileUploadedData");var t=jQuery("<form name='form_to_view_file' style='margin: 0; padding: 0;' target='_blank' method='POST' enctype='multipart/form-data' action='"+a+"'></form>");t.insertBefore(n),t.append(n),t.submit(),t.remove()}else window.open("data:"+e+";base64,"+i)},detectIE:function(){var e=window.navigator.userAgent,i=e.indexOf("MSIE ");if(0<i)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(0<e.indexOf("Trident/")){var a=e.indexOf("rv:");return parseInt(e.substring(a+3,e.indexOf(".",a)),10)}var n=e.indexOf("Edge/");return 0<n&&parseInt(e.substring(n+5,e.indexOf(".",n)),10)}};