jQuery(document).ready(function(t){$=t;var e=["../libraries/noboss/assets/plugins/js/min/jquery-confirm.min.js","../libraries/noboss/assets/plugins/stylesheets/css/jquery-confirm.min.css"].map(function(e){return"js"===e.slice(-2)&&0===t("script[src*='"+e.slice(-30)+"']").length?t("head").append('<script type="text/javascript" src="'+e+'"><\/script>'):"css"===e.slice(-3)&&0===t("link[href*='"+e.slice(-30)+"']").length?t("head").append('<link rel="stylesheet" href="'+e+'"/>'):void 0});t.when.apply(null,e).done(function(){nobossCsvImporter.CONSTRUCTOR()})});var nobossCsvImporter={CONSTRUCTOR:function(){$(".csvimportercols-btn-upload").on("click",function(e){e.preventDefault(),$('[data-csvimporter="file"]').trigger("click")}),$('[data-csvimporter="file"]').bind("change",nobossCsvImporter.fileUpload),nobossCsvImporter.dataMigrationInLoadMode()},fileUpload:function(f){nobossCsvImporter.error=!1;var p="";if(null!=typeof f.target.value&&""!==f.target.value)if(/^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/.test(f.target.value.toLowerCase())){var e=f.target.files[0],t=new FileReader;t.readAsText(e,"ISO-8859-1"),t.onload=function(e){jQuery("body").append('<div class="loader loader--fullpage"></div>'),jQuery("body").append('<div class="loader-fade"></div>');var t=jQuery(f.target).data("csvimportercols"),a=e.target.result.split(/\r\n|\n/),r=[];document.getElementById("csvimporter-result").textContent="";for(var n=document.getElementById("csvimporter-result"),i=n.appendChild(document.createElement("thead")).appendChild(document.createElement("tr")),o=0;o<t.length;o++)i.appendChild(document.createElement("th")).appendChild(document.createTextNode(t[o].label));for(var s=1;s<a.length;s++)if(void 0!==a[s]&&""!=a[s]){var l=a[s].split(";"),d={};i=n.appendChild(document.createElement("tr"));for(var u=0;u<t.length;u++)if(void 0!==l[u]&&""!=l[u]){if(d[t[u].alias]=l[u].trim().toString(),d[t[u].alias]=d[t[u].alias].replace(/""/g,'"'),d[t[u].alias]=d[t[u].alias].replace(/^"/g,""),d[t[u].alias]=d[t[u].alias].replace(/"$/g,""),d[t[u].alias]=d[t[u].alias].replace(/"/g,"'"),null!=t[u].validvalues&&""!=t[u].validvalues){validOptions=t[u].validvalues.split("|");var c=nobossCsvImporter.columnValidOptions(t[u],s,d[t[u].alias],validOptions);if(null==c.success||0==c.success){nobossCsvImporter.error=!0,p=c.message;break}}if(null!=t[u].jsfunction&&""!=t[u].jsfunction&&"function"==typeof window[t[u].jsfunction]){var m=window[t[u].jsfunction](t[u],d[t[u].alias],s);if("object"!=typeof m)console.log(Joomla.JText._("LIB_NOBOSS_FIELD_NOBOSSCSVIMPORTER_BADLY_FORMATTED_FUNCTION").replace("%s1",t[u].label).replace("%s2",t[u].jsfunction));else if(null!=m.success&&1==m.success&&null!=m.value)d[t[u].alias]=m.value;else if(null!=m.message){nobossCsvImporter.error=!0,p=m.message;break}}i.appendChild(document.createElement("td")).appendChild(document.createTextNode(d[t[u].alias])),d[t[u].alias]=encodeURI(d[t[u].alias])}else i.appendChild(document.createElement("td")).appendChild(document.createTextNode(""));if(1==nobossCsvImporter.error)break;r[s-1]=d}setTimeout(function(){jQuery("body").find(".loader.loader--fullpage").remove(),jQuery("body").find(".loader-fade").remove()},1e3),1==nobossCsvImporter.error?jQuery.alert({title:Joomla.JText._("LIB_NOBOSS_FIELD_NOBOSSCSVIMPORTER_UNABLE_UPLOAD_DATA_TITLE"),content:p,type:"red",buttons:{ok:{keys:["enter"]}}}):(jQuery('[data-csvimporter="jsonvalue"]').val(JSON.stringify(r)),jQuery("#csvimporter-result").parent().show())},t.onerror=function(){alert(Joomla.JText._("LIB_NOBOSS_FIELD_NOBOSSCSVIMPORTER_ERROR_READING_FILE")+e.fileName)},jQuery(f.target).val("")}else p=Joomla.JText._("LIB_NOBOSS_FIELD_NOBOSSITEMSLOADMODE_OPT_UNAVAILABLE")+f.target.value,nobossCsvImporter.error=!0},columnValidOptions:function(e,t,a,r){if(0<r.length)return-1<r.indexOf(a)?{success:1}:{success:0,message:Joomla.JText._("LIB_NOBOSS_FIELD_NOBOSSCSVIMPORTER_INCORRECTLY_FORMATTED_DATA").replace("%s1",a).replace("%s2",e.label).replace("%s3",t)+r.join("', '")+"'"}},dataMigrationInLoadMode:function(){jQuery("#itemsloadmode").on("change",function(){var e=jQuery(this).find("option[value="+jQuery(this).val()+"]").val(),t=null,a=jQuery(".row-fluid[data-subform-collapse-wrapper]");if(a.length<1)return!1;if(alert("sasasa"),jQuery("body").append('<div class="loader loader--fullpage"></div>'),jQuery("body").append('<div class="loader-fade"></div>'),jQuery("body").append('<div class="loader-message">'+Joomla.JText._("LIB_NOBOSS_FIELD_NOBOSSCSVIMPORTER_DATA_BEING_MIGRATED")+"</div>"),"manual"==e)a.find(".subform-repeatable-group").remove(),0<(t=JSON.parse(jQuery('[data-csvimporter="jsonvalue"]').val())).length&&(jQuery.each(t,function(e,t){var r=[];jQuery.each(t,function(e,t){r[e]=decodeURI(t)}),t=null,a.find(".btn-toolbar .btn-group a.group-add").click();var n=a.find('[data-new="true"]').last();n.find("input").not('[type="radio"]').each(function(){null!=jQuery(this).attr("name")&&(nameField=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],jQuery(this).is(".minicolors")?jQuery(this).minicolors("value",r[nameField]):jQuery(this).val(r[nameField]))}),n.find("select").each(function(){nameField=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],jQuery(this).val(r[nameField]),jQuery(this).trigger("liszt:updated")}),n.find("fieldset.radio").each(function(){var e=jQuery(this).find('label[class*="active"]').first().attr("for"),t=jQuery(this).find("input#"+e);nameField=t.attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2];var a=n.find('input[name$="\\['+nameField+'\\]"][value="'+r[nameField]+'"]');a.siblings('label[for="'+a.attr("id")+'"]').click()}),n.find(".controls > textarea").each(function(){null!=jQuery(this).attr("name")&&(nameField=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],jQuery(this).val(r[nameField]))}),n.find(".js-editor-tinymce textarea").each(function(){nameField=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],jQuery(this).val(r[nameField]).parent().find("iframe").contents().find("body").html(r[nameField])})}),nobosssubform.toggleCollapseAll("shrink",a),jQuery('[data-csvimporter="jsonvalue"]').val(),document.getElementById("csvimporter-result").textContent="");else if("csv"==e){var r=a.find(".subform-repeatable-group[data-base-name]");if(1<r.length||1==r.length&&document.formvalidator.isValid(document.adminForm)){var n=[];r.each(function(){var a=[],r="";jQuery(this).find("input").not('[type="radio"]').each(function(){null!=jQuery(this).attr("name")&&(r=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],a[r]=jQuery(this).val())}),jQuery(this).find("select").each(function(){null!=jQuery(this).attr("name")&&(r=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],a[r]=jQuery(this).val())}),jQuery(this).find("fieldset.radio").each(function(){var e=jQuery(this).find('label[class*="active"]').first().attr("for"),t=jQuery(this).find("input#"+e);r=t.attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],a[r]=t.val()}),jQuery(this).find(".controls > textarea").each(function(){null!=jQuery(this).attr("name")&&(r=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],a[r]=jQuery(this).html())}),jQuery(this).find(".js-editor-tinymce textarea").each(function(){r=jQuery(this).attr("name").match(/jform(\[([a-z0-9_-]*)\])*/)[2],a[r]=jQuery(this).parent().find("iframe").contents().find("body").html()}),n.push(Object.assign({},a)),tinymce.get(jQuery(this).find(".js-editor-tinymce textarea").attr("id")).remove(),jQuery(this).remove()}),jQuery('[data-csvimporter="jsonvalue"]').val(JSON.stringify(n)),a.find(".subform-repeatable-group").remove(),document.getElementById("csvimporter-result").textContent=""}}setTimeout(function(){jQuery("body").find(".loader.loader--fullpage").remove(),jQuery("body").find(".loader-fade").remove(),jQuery("body").find(".loader-message").remove(),Joomla.submitbutton("module.apply")},4e3)})}};